#!/bin/bash

path_to_mlr="./mlr"
indir="./regtest/input"

go build mlr.go
if [ $? -ne 0 ]; then
  exit 1
fi

# ----------------------------------------------------------------
run_mlr() {
  echo
  echo ---------------------------------------------------------------- "$@"
  echo $path_to_mlr "$@"
  echo
  $path_to_mlr "$@"
}

# ----------------------------------------------------------------
mlr_expect_fail() {
  echo
  echo $path_to_mlr "$@"
  echo
  $path_to_mlr "$@"
  status=$?
  if [ $status -eq 0 ]; then
    echo "failed to fail"
  fi
}

# ----------------------------------------------------------------
run_cat() {
  echo
  echo cat "$@"
  echo
  cat "$@"
}

# ----------------------------------------------------------------
announce() {
  echo
  echo "================================================================"
  echo
  echo "$@"
}

# ----------------------------------------------------------------
mention() {
  echo
  echo ---------------------------------------------------------------- "$@"
}

# ================================================================

echo 's=1,t=2,u=3,v=4,w=5,x=6,y=7,z=8' | run_mlr reorder -f x,y -b u
echo 's=1,t=2,u=3,v=4,w=5,x=6,y=7,z=8' | run_mlr reorder -f u,v -b x
echo 's=1,t=2,u=3,v=4,w=5,x=6,y=7,z=8' | run_mlr reorder -f z,w,s -b v
echo 's=1,t=2,u=3,v=4,w=5,x=6,y=7,z=8' | run_mlr reorder -f u,v -b nonesuch
echo 's=1,t=2,u=3,v=4,w=5,x=6,y=7,z=8' | run_mlr reorder -f u,nonesuch -b x
echo

echo 's=1,t=2,u=3,v=4,w=5,x=6,y=7,z=8' | run_mlr reorder -f x,y -a u
echo 's=1,t=2,u=3,v=4,w=5,x=6,y=7,z=8' | run_mlr reorder -f u,v -a x
echo 's=1,t=2,u=3,v=4,w=5,x=6,y=7,z=8' | run_mlr reorder -f z,w,s -a v
echo 's=1,t=2,u=3,v=4,w=5,x=6,y=7,z=8' | run_mlr reorder -f u,v -a nonesuch
echo 's=1,t=2,u=3,v=4,w=5,x=6,y=7,z=8' | run_mlr reorder -f u,nonesuch -a x
echo

# ================================================================
