

================================================================
MAPVAR EMIT

mlr -n put end {
  @a[2][3] = 4;
  b[2][3] = 8;
  emit  (@a, b, {2:{3:12}});
  emitp (@a, b, {2:{3:12}});
  emit {};
  emit  (@a, b, {2:{3:12}}), "t";
  emitp (@a, b, {2:{3:12}}), "t";
  emit {};
  emit  (@a, b, {2:{3:12}}), "t", "u";
  emitp (@a, b, {2:{3:12}}), "t", "u";
}
2:3=12
a:2:3=4,b:2:3=8,_:2:3=12

t=2,3=12
t=2,a:3=4,b:3=8,_:3=12

t=2,u=3,a=4,b=8,_=12
t=2,u=3,a=4,b=8,_=12

mlr -n put end {
  @a[2][3] = 4;
  b[2][3] = 8;
  emitp (@a, b, {2:{3:12}});
  emit  (@a, b, {2:{3:12}});
  emit {};
  emitp (@a, b, {2:{3:12}}), "t";
  emit  (@a, b, {2:{3:12}}), "t";
  emit {};
  emitp (@a, b, {2:{3:12}}), "t", "u";
  emit  (@a, b, {2:{3:12}}), "t", "u";
}
a:2:3=4,b:2:3=8,_:2:3=12
2:3=12

t=2,a:3=4,b:3=8,_:3=12
t=2,3=12

t=2,u=3,a=4,b=8,_=12
t=2,u=3,a=4,b=8,_=12

mlr --opprint --from ./reg-test/input/abixy put -q 
  @output[NR] = $*;
  end {
    for ((nr, k), v in @output) {
      if (nr == 4 || k == "i") {
        unset @output[nr][k]
      }
    }
    emitp @output, "NR", "k"
  }

NR k output
1  a pan
1  b pan
1  x 0.3467901443380824
1  y 0.7268028627434533
2  a eks
2  b pan
2  x 0.7586799647899636
2  y 0.5221511083334797
3  a wye
3  b wye
3  x 0.20460330576630303
3  y 0.33831852551664776
5  a wye
5  b pan
5  x 0.5732889198020006
5  y 0.8636244699032729
6  a zee
6  b pan
6  x 0.5271261600918548
6  y 0.49322128674835697
7  a eks
7  b zee
7  x 0.6117840605678454
7  y 0.1878849191181694
8  a zee
8  b wye
8  x 0.5985540091064224
8  y 0.976181385699006
9  a hat
9  b wye
9  x 0.03144187646093577
9  y 0.7495507603507059
10 a pan
10 b wye
10 x 0.5026260055412137
10 y 0.9526183602969864

