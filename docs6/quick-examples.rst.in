Quick examples
================================================================

Column select:

GENRST_SHOW_COMMAND
mlr --csv cut -f hostname,uptime mydata.csv
GENRST_EOF

Add new columns as function of other columns:

GENRST_CARDIFY_HIGHLIGHT_ONE
mlr --nidx put '$sum = $7 < 0.0 ? 3.5 : $7 + 2.1*$8' *.dat
GENRST_EOF

Row filter:

GENRST_CARDIFY_HIGHLIGHT_ONE
mlr --csv filter '$status != "down" && $upsec >= 10000' *.csv
GENRST_EOF

Apply column labels and pretty-print:

GENRST_CARDIFY_HIGHLIGHT_ONE
grep -v '^#' /etc/group | mlr --ifs : --nidx --opprint label group,pass,gid,member then sort -f group
GENRST_EOF

Join multiple data sources on key columns:

GENRST_CARDIFY_HIGHLIGHT_ONE
mlr join -j account_id -f accounts.dat then group-by account_name balances.dat
GENRST_EOF

Mulltiple formats including JSON:

GENRST_CARDIFY_HIGHLIGHT_ONE
mlr --json put '$attr = sub($attr, "([0-9]+)_([0-9]+)_.*", "\1:\2")' data/*.json
GENRST_EOF

Aggregate per-column statistics:

GENRST_CARDIFY_HIGHLIGHT_ONE
mlr stats1 -a min,mean,max,p10,p50,p90 -f flag,u,v data/*
GENRST_EOF

Linear regression:

GENRST_CARDIFY_HIGHLIGHT_ONE
mlr stats2 -a linreg-pca -f u,v -g shape data/*
GENRST_EOF

Aggregate custom per-column statistics:

GENRST_CARDIFY_HIGHLIGHT_ONE
mlr put -q '@sum[$a][$b] += $x; end {emit @sum, "a", "b"}' data/*
GENRST_EOF

Iterate over data using DSL expressions:

GENRST_CARDIFY_HIGHLIGHT_ONE
mlr --from estimates.tbl put '
  for (k,v in $*) {
    if (is_numeric(v) && k =~ "^[t-z].*$") {
      $sum += v; $count += 1
    }
  }
  $mean = $sum / $count # no assignment if count unset
'
GENRST_EOF

Run DSL expressions from a script file:

GENRST_CARDIFY_HIGHLIGHT_ONE
mlr --from infile.dat put -f analyze.mlr
GENRST_EOF

Split/reduce output to multiple filenames:

GENRST_CARDIFY_HIGHLIGHT_ONE
mlr --from infile.dat put 'tee > "./taps/data-".$a."-".$b, $*'
GENRST_EOF

Compressed I/O:

GENRST_CARDIFY_HIGHLIGHT_ONE
mlr --from infile.dat put 'tee | "gzip > ./taps/data-".$a."-".$b.".gz", $*'
GENRST_EOF

Interoperate with other data-processing tools using standard pipes:

GENRST_CARDIFY_HIGHLIGHT_ONE
mlr --from infile.dat put -q '@v=$*; dump | "jq .[]"'
GENRST_EOF

Tap/trace:

GENRST_CARDIFY_HIGHLIGHT_ONE
mlr --from infile.dat put  '(NR % 1000 == 0) { print > stderr, "Checkpoint ".NR}'
GENRST_EOF
